{"version":3,"names":["TransformKeys","x","y","scale","scaleX","scaleY","skewX","skewY","perspective","rotate","rotateX","rotateY","rotateZ","matrix","OtherNativeKeys","opacity","DefaultValues","DefaultTransition","type","duration","DefaultTransitionTime","Eases","linear","Easing","easeIn","ease","easeInOut","inOut","easeOut","out","circIn","circle","circInOut","circOut","backIn","back","backInOut","backOut","addKeysToSet","set","Set","i","length","obj","keys","Object","add","createMotionComponent","Component","forwardRef","MotionComponent","ref","animate","animateProps","initial","initialProps","exit","transition","transformOrigin","style","styleProp","onLayout","onLayoutProp","whileTap","whileHover","onAnimationComplete","rest","refAnims","useRef","animKeysSet","values","assign","pressed","hovered","useContext","ContextPressable","animKeys","animValues","map","key","update","anims","current","useNativeDriver","every","isProp","undefined","value","valueInitial","isStr","isString","isArr","isArray","startValue","animValue","Animated","Value","valueInterp","toValue","fromInterp","from","interpolation","interpolate","inputRange","outputRange","transitionForKey","config","timing","isNumber","easing","animOptions","requestAnimationFrame","callback","loop","animation","spring","iterations","start","useMemo","animProps","transforms","entries","forEach","push","transform","useTransformOrigin","StyleSheet","compose","createMotionAnimatedComponent","component","createAnimatedComponent"],"sources":["createMotionComponent.tsx"],"sourcesContent":["import { isArray, isNumber, isString } from '@legendapp/tools';\nimport React, { ComponentPropsWithRef, ComponentType, forwardRef, ReactElement, Ref, useContext, useMemo, useRef } from 'react';\nimport { Animated, Easing, StyleProp, StyleSheet, TransformsStyle } from 'react-native';\nimport { config } from './configureMotion';\nimport { DefaultTransitionTime } from './Constants';\nimport type {\n    ComponentStyle,\n    EaseFunction,\n    MotionComponentProps,\n    MotionTransition,\n    MotionTransitionTween,\n    PropsTransforms,\n    UnionToIntersection,\n} from './Interfaces';\nimport { ContextPressable } from './MotionPressable';\nimport { useTransformOrigin } from './useTransformOrigin';\n\ninterface AnimInfo {\n    animValue: Animated.Value;\n    value: any;\n    valueInterp?: number;\n    interpolation?: any;\n}\n\nconst TransformKeys: Record<keyof PropsTransforms, keyof UnionToIntersection<TransformsStyle['transform'][number]>> = {\n    x: 'translateX',\n    y: 'translateY',\n    scale: 'scale',\n    scaleX: 'scaleX',\n    scaleY: 'scaleY',\n    skewX: 'skewX',\n    skewY: 'skewY',\n    perspective: 'perspective',\n    rotate: 'rotate',\n    rotateX: 'rotateX',\n    rotateY: 'rotateY',\n    rotateZ: 'rotateZ',\n    matrix: 'matrix',\n};\n\nconst OtherNativeKeys = {\n    opacity: 'opacity',\n} as const;\n\nconst DefaultValues: Record<keyof PropsTransforms | keyof typeof OtherNativeKeys, any> = {\n    x: 0,\n    y: 0,\n    scale: 1,\n    scaleX: 1,\n    scaleY: 1,\n    skewX: '0deg',\n    skewY: '0deg',\n    perspective: 0,\n    rotate: '0deg',\n    rotateX: '0deg',\n    rotateY: '0deg',\n    rotateZ: '0deg',\n    matrix: [],\n    opacity: 1,\n};\n\nconst DefaultTransition: MotionTransition = { type: 'tween', duration: DefaultTransitionTime };\nconst Eases: Record<EaseFunction, (value: number) => number> = {\n    linear: Easing.linear,\n    easeIn: Easing.ease,\n    easeInOut: Easing.inOut(Easing.ease),\n    easeOut: Easing.out(Easing.ease),\n    circIn: Easing.circle,\n    circInOut: Easing.inOut(Easing.circle),\n    circOut: Easing.out(Easing.circle),\n    backIn: Easing.back(2),\n    backInOut: Easing.inOut(Easing.back(2)),\n    backOut: Easing.out(Easing.back(2)),\n};\n\nfunction addKeysToSet(...objs: Record<string, any>[]) {\n    const set = new Set<string>();\n    for (let i = 0; i < objs.length; i++) {\n        const obj = objs[i];\n        if (obj) {\n            const keys = Object.keys(obj);\n            for (let i = 0; i < keys.length; i++) {\n                set.add(keys[i]);\n            }\n        }\n    }\n    return set;\n}\n\nexport function createMotionComponent<T extends ComponentType<any>, TExtraProps = {}>(Component: Animated.AnimatedComponent<T> | T) {\n    return forwardRef(function MotionComponent<TAnimate, TAnimateProps>(\n        {\n            animate,\n            animateProps,\n            initial,\n            initialProps,\n            exit,\n            transition,\n            transformOrigin,\n            style: styleProp,\n            onLayout: onLayoutProp,\n            whileTap,\n            whileHover,\n            onAnimationComplete,\n            ...rest\n        }: Animated.AnimatedProps<ComponentPropsWithRef<T & TExtraProps>> &\n            MotionComponentProps<T, ComponentStyle<T>, TAnimate, TAnimateProps>,\n        // @ts-ignore\n        ref: Ref<InstanceType<T>>\n    ) {\n        const refAnims = useRef<Partial<Record<string, AnimInfo>>>({});\n\n        // Generate the arrays of keys and values for transitioning. These are used as deps of useMemo\n        // so that it will update whenever a key or value changes.\n        const animKeysSet = addKeysToSet(initial, animate, animateProps, whileTap, whileHover, exit);\n        const values = Object.assign({}, animate);\n\n        if (animateProps) {\n            addKeysToSet(animKeysSet, animateProps);\n            Object.assign(values, animateProps);\n        }\n\n        if (whileTap || whileHover) {\n            const { pressed, hovered } = useContext(ContextPressable);\n\n            if (whileHover) {\n                addKeysToSet(animKeysSet, whileHover);\n                if (hovered) {\n                    Object.assign(values, whileHover);\n                }\n            }\n            if (whileTap) {\n                addKeysToSet(animKeysSet, whileTap);\n                if (pressed) {\n                    Object.assign(values, whileTap);\n                }\n            }\n        }\n\n        if (exit) {\n            addKeysToSet(animKeysSet, exit);\n        }\n\n        const animKeys = [...animKeysSet];\n        const animValues = animKeys.map((key) => values[key]);\n\n        const update = () => {\n            const anims = refAnims.current;\n\n            const useNativeDriver = !animateProps && animKeys.every((key) => !!OtherNativeKeys[key] || !!TransformKeys[key]);\n\n            for (let i = 0; i < animKeys.length; i++) {\n                const key = animKeys[i];\n                const isProp = animateProps?.[key] !== undefined;\n                let value = values[key];\n                const valueInitial = (isProp ? initialProps?.[key] : initial?.[key]) ?? value ?? DefaultValues[key];\n                if (value === undefined) {\n                    value = valueInitial ?? DefaultValues[key];\n                }\n\n                if (!anims[key] || anims[key].value !== value) {\n                    const isStr = isString(valueInitial);\n                    const isArr = isArray(valueInitial);\n\n                    // If this is the first run or it's a new key, create the Animated.Value\n                    if (!anims[key]) {\n                        const startValue = isStr || isArr ? 1 : (valueInitial as number);\n                        const animValue = new Animated.Value(startValue);\n                        anims[key] = {\n                            value: valueInitial,\n                            animValue,\n                            valueInterp: isStr ? 1 : undefined,\n                        };\n                    }\n\n                    let toValue: number;\n                    // If string or array it needs to interpolate, so toggle back and forth between 0 and 1,\n                    // interpolating from current value to target value\n                    if (isStr || isArr) {\n                        const fromInterp = anims[key].valueInterp;\n                        const from = anims[key].value;\n                        anims[key].interpolation = anims[key].animValue.interpolate({\n                            inputRange: [0, 1],\n                            outputRange: fromInterp === 1 ? [value, from] : [from, value],\n                        });\n                        anims[key].valueInterp = toValue = 1 - fromInterp;\n                        anims[key].value = value;\n                    } else {\n                        anims[key].value = toValue = value as number;\n                    }\n\n                    // Get the transition for this key, the 'default' key, the root transition, or default transition if no transition prop\n                    const transitionForKey: MotionTransition =\n                        transition?.[key] || transition?.['default'] || transition || DefaultTransition;\n\n                    if (\n                        config.timing === 's' &&\n                        transitionForKey !== DefaultTransition &&\n                        isNumber((transitionForKey as MotionTransitionTween).duration)\n                    ) {\n                        (transitionForKey as MotionTransitionTween).duration *= 1000;\n                    }\n\n                    if (isString((transitionForKey as MotionTransitionTween).easing)) {\n                        (transitionForKey as MotionTransitionTween).easing =\n                            Eases[(transitionForKey as MotionTransitionTween).easing as unknown as EaseFunction];\n                    }\n                    if (isString((transitionForKey as MotionTransitionTween).ease)) {\n                        (transitionForKey as MotionTransitionTween).ease =\n                            Eases[(transitionForKey as MotionTransitionTween).ease as unknown as EaseFunction];\n                    }\n\n                    const animOptions = Object.assign(\n                        {\n                            toValue,\n                            useNativeDriver,\n                        },\n                        transitionForKey\n                    );\n\n                    // This typeof check is to make it work when rendered server-side like in Next.js\n                    if (typeof requestAnimationFrame !== 'undefined') {\n                        requestAnimationFrame(() => {\n                            const callback = onAnimationComplete ? () => onAnimationComplete(key) : undefined;\n                            const { loop, type } = transitionForKey;\n\n                            let animation: Animated.CompositeAnimation;\n\n                            // Spring or timing based on the transition prop\n                            if (type === 'spring') {\n                                animation = Animated.spring(anims[key].animValue, animOptions);\n                            } else {\n                                animation = Animated.timing(anims[key].animValue, animOptions as Animated.TimingAnimationConfig);\n                            }\n\n                            // Loop based on the transition prop\n                            if (loop !== undefined) {\n                                animation = Animated.loop(animation, { iterations: loop });\n                            }\n\n                            animation.start(callback);\n                        });\n                    }\n                }\n            }\n        };\n\n        useMemo(update, animValues); // eslint-disable-line react-hooks/exhaustive-deps\n\n        // Apply the animations to the style object\n        const style: StyleProp<any> = {};\n        const animProps = {};\n        const transforms: { key: string; value: AnimInfo }[] = [];\n        Object.entries(refAnims.current).forEach(([key, value]) => {\n            if (animateProps?.[key] !== undefined) {\n                animProps[key] = value.interpolation || value.animValue;\n            } else if (TransformKeys[key]) {\n                transforms.push({ key, value });\n            } else {\n                style[key] = value.interpolation || value.animValue;\n            }\n        });\n\n        // Map the transforms into an Animated transforms array\n        if (transforms.length) {\n            style.transform = transforms.map(({ key, value }) => ({\n                [TransformKeys[key]]: value.interpolation || value.animValue,\n            }));\n        }\n\n        const onLayout = transformOrigin ? useTransformOrigin(transformOrigin, style.transform, onLayoutProp) : onLayoutProp;\n\n        // @ts-ignore\n        return <Component style={StyleSheet.compose(styleProp, style)} onLayout={onLayout} {...rest} {...animProps} ref={ref} />;\n    }) as <TAnimate, TAnimateProps>(\n        p: Animated.AnimatedProps<ComponentPropsWithRef<T>> &\n            TExtraProps &\n            MotionComponentProps<T, ComponentStyle<T>, TAnimate, TAnimateProps>,\n        // @ts-ignore\n        ref: Ref<InstanceType<T>>\n    ) => ReactElement;\n}\nexport function createMotionAnimatedComponent<T extends ComponentType<any>>(component: T) {\n    return createMotionComponent(Animated.createAnimatedComponent(component));\n}\n"],"mappings":"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"}